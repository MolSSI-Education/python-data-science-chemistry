
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Cleaning with Pandas &#8212; Python Data and Scripting - Level 2</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plotting with seaborn" href="2-seaborn.html" />
    <link rel="prev" title="Reading data from PDFs" href="2-ocr-tabula.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/molssi_main_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python Data and Scripting - Level 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Workshop Template
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="setup.html">
   Set Up
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="1-intro-objectives.html">
   Session 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="1-pandas-dataframes-esol.html">
     Working with Pandas DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1-numpy-arrays.html">
     Working with NumPy Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1-matplotlib.html">
     Plotting with Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1-homework.html">
     Session 1 Homework
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="homework_1_solutions.html">
     Session 1 Homework Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="2-intro-objectives.html">
   Session 2
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="2-ocr-tabula.html">
     Reading data from PDFs
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Data Cleaning with Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2-seaborn.html">
     Plotting with seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2-homework.html">
     Session 2 Homework
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="3-intro-objectives.html">
   Session 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3-linear-scikitlearn.html">
     Linear Fitting with SciKit Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-regex.html">
     Regular Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-homework.html">
     Session 3 Homework
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="4-intro-objectives.html">
   Session 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="4-nonlinear-scikitlearn.html">
     Nonlinear Fitting with ScikitLearn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4-linear-statsmodels.html">
     Linear Fitting with statsmodels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4-interactive-visualizations.html">
     Interactive Visualizations with plotly
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2-pandas-datacleaning.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/MolSSI-Education/WORKSHOP_NAME"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/MolSSI-Education/WORKSHOP_NAME/issues/new?title=Issue%20on%20page%20%2F2-pandas-datacleaning.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/MolSSI-Education/WORKSHOP_NAME/main?urlpath=tree/book/2-pandas-datacleaning.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dropping-unneccessary-data">
   Dropping unneccessary data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changing-column-names">
   Changing column names
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixing-data-types">
   Fixing Data Types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-string-methods">
   Pandas string methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changing-the-data-type-of-multiple-columns">
   Changing the data type of multiple columns
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="data-cleaning-with-pandas">
<h1>Data Cleaning with Pandas<a class="headerlink" href="#data-cleaning-with-pandas" title="Permalink to this headline">¶</a></h1>
<div class="overview">
   <p class="overview-title">Overview</p>
    <p>Questions</p>
        <ul>
            <li>What does 'clean data' mean?</li>
            <li>How can I drop unnecessary data from my dataframe?</li>
            <li>How can I change column or row names in a dataframe?</li>
            <li>How can I cast columns to the correct data type?</li>
        </ul>
    <p>Objectives:</p>
        <ul>
            <li>Use pandas to drop unnecessary data from our dataframe.</li>
            <li>Learn how to rename pandas columns.</li>
            <li>Use pandas string methods to correct characters.</li>
            <li>Learn how to cast columns to the correct data type.</li>
        </ul>
    <p>Keypoints:</p>
        <ul>
            <li>Data cleaning prepares data for analysis.</li>
            <li>Pandas has built-in methods for handling data cleaning, particular missing data.</li>
        </ul>
    </div>
<p>In this section, we’ll read in the data we extracted in the last lesson. You may have noticed in the last session that the data in these dataframes didn’t look great. There were columns that appeared to have no values. Once we start working with the data, we are going to see some additional problems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;potts_table1.csv&quot;</span><span class="p">)</span>
<span class="n">fpath2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;potts_table2.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Compound</th>
      <th>log P</th>
      <th>Unnamed: 1</th>
      <th>II</th>
      <th>Hy</th>
      <th>H,</th>
      <th>MV</th>
      <th>R,</th>
      <th>log Kou</th>
      <th>log Kyex</th>
      <th>Unnamed: 2</th>
      <th>log Kpep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>NaN</td>
      <td>water</td>
      <td>— 6.85</td>
      <td>NaN</td>
      <td>0.45</td>
      <td>0.82</td>
      <td>0.35</td>
      <td>10.6</td>
      <td>0.00</td>
      <td>— 1.38</td>
      <td>— 4,38</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>'</td>
      <td>methanol</td>
      <td>— 6.68</td>
      <td>NaN</td>
      <td>0.44</td>
      <td>0.43</td>
      <td>0.47</td>
      <td>21.7</td>
      <td>0.28</td>
      <td>—0.73</td>
      <td>— 2.42</td>
      <td>NaN</td>
      <td>— 2.80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>NaN</td>
      <td>methanoic acid</td>
      <td>— 7.08</td>
      <td>NaN</td>
      <td>0.60</td>
      <td>0.75</td>
      <td>0.38</td>
      <td>22.3</td>
      <td>0.30</td>
      <td>—0.54</td>
      <td>— 3.93</td>
      <td>NaN</td>
      <td>— 3.63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>NaN</td>
      <td>ethanol</td>
      <td>— 6.66</td>
      <td>NaN</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>31.9</td>
      <td>0.25</td>
      <td>—0.32</td>
      <td>—2.24</td>
      <td>NaN</td>
      <td>—2.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>NaN</td>
      <td>ethanoic acid</td>
      <td>—7.01</td>
      <td>NaN</td>
      <td>0.65</td>
      <td>0.61</td>
      <td>0.45</td>
      <td>33.4</td>
      <td>0.27</td>
      <td>—0.31</td>
      <td>— 3.28</td>
      <td>NaN</td>
      <td>—2.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="dropping-unneccessary-data">
<h2>Dropping unneccessary data<a class="headerlink" href="#dropping-unneccessary-data" title="Permalink to this headline">¶</a></h2>
<p>In some cases, we might have data in our dataframe that we don’t need. We will want to discard or “drop” this data from the dataframe. For the dataframe we just loaded, for example, we can see that the data in columns 0, 1, 4, 12 appear to not have any values.</p>
<div class="exercise-this-is-a-title exercise">
<p class="exercise-title">Check your understanding</p>
    <p>What pandas method can you use to see how many non-null values you have in each column?</p>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div><p>There are two methods you might use to drop data from a dataframe. These are <code class="docutils literal notranslate"><span class="pre">drop</span></code>, and <code class="docutils literal notranslate"><span class="pre">dropna</span></code>. Drop is used when you have specific rows or columns you want to remove from the dataframe, while <code class="docutils literal notranslate"><span class="pre">dropna</span></code> is used when you want to drop columns or rows which contain <code class="docutils literal notranslate"><span class="pre">NaN</span></code> or “not a number” values. This occurs when there are no values in a data cell.</p>
<p>In the output of <code class="docutils literal notranslate"><span class="pre">info</span></code> above, we can see that there are two columns which contain 0 non-null values. This means that all of the values in these columns are <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. We can safely discard these columns. We’ll use the <code class="docutils literal notranslate"><span class="pre">dropna</span></code> function to get rid of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">table1</span><span class="o">.</span><span class="n">dropna</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method dropna in module pandas.core.frame:

dropna(axis=0, how=&#39;any&#39;, thresh=None, subset=None, inplace=False) method of pandas.core.frame.DataFrame instance
    Remove missing values.
    
    See the :ref:`User Guide &lt;missing_data&gt;` for more on which values are
    considered missing, and how to work with missing data.
    
    Parameters
    ----------
    axis : {0 or &#39;index&#39;, 1 or &#39;columns&#39;}, default 0
        Determine if rows or columns which contain missing values are
        removed.
    
        * 0, or &#39;index&#39; : Drop rows which contain missing values.
        * 1, or &#39;columns&#39; : Drop columns which contain missing value.
    
        .. versionchanged:: 1.0.0
    
           Pass tuple or list to drop on multiple axes.
           Only a single axis is allowed.
    
    how : {&#39;any&#39;, &#39;all&#39;}, default &#39;any&#39;
        Determine if row or column is removed from DataFrame, when we have
        at least one NA or all NA.
    
        * &#39;any&#39; : If any NA values are present, drop that row or column.
        * &#39;all&#39; : If all values are NA, drop that row or column.
    
    thresh : int, optional
        Require that many non-NA values.
    subset : array-like, optional
        Labels along other axis to consider, e.g. if you are dropping rows
        these would be a list of columns to include.
    inplace : bool, default False
        If True, do operation inplace and return None.
    
    Returns
    -------
    DataFrame or None
        DataFrame with NA entries dropped from it or None if ``inplace=True``.
    
    See Also
    --------
    DataFrame.isna: Indicate missing values.
    DataFrame.notna : Indicate existing (non-missing) values.
    DataFrame.fillna : Replace missing values.
    Series.dropna : Drop missing values.
    Index.dropna : Drop missing indices.
    
    Examples
    --------
    &gt;&gt;&gt; df = pd.DataFrame({&quot;name&quot;: [&#39;Alfred&#39;, &#39;Batman&#39;, &#39;Catwoman&#39;],
    ...                    &quot;toy&quot;: [np.nan, &#39;Batmobile&#39;, &#39;Bullwhip&#39;],
    ...                    &quot;born&quot;: [pd.NaT, pd.Timestamp(&quot;1940-04-25&quot;),
    ...                             pd.NaT]})
    &gt;&gt;&gt; df
           name        toy       born
    0    Alfred        NaN        NaT
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Drop the rows where at least one element is missing.
    
    &gt;&gt;&gt; df.dropna()
         name        toy       born
    1  Batman  Batmobile 1940-04-25
    
    Drop the columns where at least one element is missing.
    
    &gt;&gt;&gt; df.dropna(axis=&#39;columns&#39;)
           name
    0    Alfred
    1    Batman
    2  Catwoman
    
    Drop the rows where all elements are missing.
    
    &gt;&gt;&gt; df.dropna(how=&#39;all&#39;)
           name        toy       born
    0    Alfred        NaN        NaT
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Keep only the rows with at least 2 non-NA values.
    
    &gt;&gt;&gt; df.dropna(thresh=2)
           name        toy       born
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Define in which columns to look for missing values.
    
    &gt;&gt;&gt; df.dropna(subset=[&#39;name&#39;, &#39;toy&#39;])
           name        toy       born
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Keep the DataFrame with valid entries in the same variable.
    
    &gt;&gt;&gt; df.dropna(inplace=True)
    &gt;&gt;&gt; df
         name        toy       born
    1  Batman  Batmobile 1940-04-25
</pre></div>
</div>
</div>
</div>
<p>Before saving the dataframe, we’ll look at and and discuss output from this function.</p>
<p>By default, the function <code class="docutils literal notranslate"><span class="pre">dropna</span></code> will work on <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">0</span></code> or the rows of the dataframe, and will drop any row which contains a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. You will see this results in a dataframe with no data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Compound</th>
      <th>log P</th>
      <th>Unnamed: 1</th>
      <th>II</th>
      <th>Hy</th>
      <th>H,</th>
      <th>MV</th>
      <th>R,</th>
      <th>log Kou</th>
      <th>log Kyex</th>
      <th>Unnamed: 2</th>
      <th>log Kpep</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">dropna</span></code> returns a dataframe and does not overwrite the original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 14 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   Unnamed: 0    37 non-null     int64  
 1   Unnamed: 0.1  1 non-null      object 
 2   Compound      37 non-null     object 
 3   log P         37 non-null     object 
 4   Unnamed: 1    0 non-null      float64
 5   II            37 non-null     float64
 6   Hy            37 non-null     float64
 7   H,            37 non-null     float64
 8   MV            37 non-null     object 
 9   R,            37 non-null     float64
 10  log Kou       37 non-null     object 
 11  log Kyex      31 non-null     object 
 12  Unnamed: 2    0 non-null      float64
 13  log Kpep      25 non-null     object 
dtypes: float64(6), int64(1), object(7)
memory usage: 4.2+ KB
</pre></div>
</div>
</div>
</div>
<p>We can switch to dropping columns which have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values by adding the argument <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   Unnamed: 0  37 non-null     int64  
 1   Compound    37 non-null     object 
 2   log P       37 non-null     object 
 3   II          37 non-null     float64
 4   Hy          37 non-null     float64
 5   H,          37 non-null     float64
 6   MV          37 non-null     object 
 7   R,          37 non-null     float64
 8   log Kou     37 non-null     object 
dtypes: float64(4), int64(1), object(4)
memory usage: 2.7+ KB
</pre></div>
</div>
</div>
</div>
<p>This is closer to what we want. However, you’ll notice that this has dropped some columns which have data. By default, pandas will drop a column which contains <strong>any</strong> <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values. This may not be what we want in many cases because some values may simply be missing rather than incorrect.</p>
<p>We can add an additional argument, <code class="docutils literal notranslate"><span class="pre">how=all</span></code>, to drop only columns whose values are <strong>all</strong> <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. By default, this function argument is <code class="docutils literal notranslate"><span class="pre">how=any</span></code>. Once we are sure we would like to keep this as our dataframe, we can add <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to the function call to overwrite the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Compound</th>
      <th>log P</th>
      <th>II</th>
      <th>Hy</th>
      <th>H,</th>
      <th>MV</th>
      <th>R,</th>
      <th>log Kou</th>
      <th>log Kyex</th>
      <th>log Kpep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>NaN</td>
      <td>water</td>
      <td>— 6.85</td>
      <td>0.45</td>
      <td>0.82</td>
      <td>0.35</td>
      <td>10.6</td>
      <td>0.00</td>
      <td>— 1.38</td>
      <td>— 4,38</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>'</td>
      <td>methanol</td>
      <td>— 6.68</td>
      <td>0.44</td>
      <td>0.43</td>
      <td>0.47</td>
      <td>21.7</td>
      <td>0.28</td>
      <td>—0.73</td>
      <td>— 2.42</td>
      <td>— 2.80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>NaN</td>
      <td>methanoic acid</td>
      <td>— 7.08</td>
      <td>0.60</td>
      <td>0.75</td>
      <td>0.38</td>
      <td>22.3</td>
      <td>0.30</td>
      <td>—0.54</td>
      <td>— 3.93</td>
      <td>— 3.63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>NaN</td>
      <td>ethanol</td>
      <td>— 6.66</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>31.9</td>
      <td>0.25</td>
      <td>—0.32</td>
      <td>—2.24</td>
      <td>—2.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>NaN</td>
      <td>ethanoic acid</td>
      <td>—7.01</td>
      <td>0.65</td>
      <td>0.61</td>
      <td>0.45</td>
      <td>33.4</td>
      <td>0.27</td>
      <td>—0.31</td>
      <td>— 3.28</td>
      <td>—2.90</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>NaN</td>
      <td>n-propanol</td>
      <td>— 6.41</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>42.2</td>
      <td>0.24</td>
      <td>0.34</td>
      <td>— 1.48</td>
      <td>—1.52</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>NaN</td>
      <td>n-propanoic acid</td>
      <td>—7.01</td>
      <td>0.65</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>43.6</td>
      <td>0.23</td>
      <td>0.26</td>
      <td>— 2.64</td>
      <td>—2.14</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>NaN</td>
      <td>butane-2-one</td>
      <td>— 5.90</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>0.51</td>
      <td>49.4</td>
      <td>0.17</td>
      <td>0.28</td>
      <td>— 0.25</td>
      <td>—Q.25</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>NaN</td>
      <td>benzene</td>
      <td>—4,.5]1</td>
      <td>0.52</td>
      <td>0.00</td>
      <td>0.14</td>
      <td>50.0</td>
      <td>0.61</td>
      <td>2.00</td>
      <td>2.29</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>NaN</td>
      <td>diethyl ether</td>
      <td>— 5.35</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.45</td>
      <td>52.0</td>
      <td>0.04</td>
      <td>0.83</td>
      <td>0.66</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>NaN</td>
      <td>n-butanol</td>
      <td>— 6.16</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>52.4</td>
      <td>0.22</td>
      <td>0.88</td>
      <td>— 1.08</td>
      <td>—0.70</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>NaN</td>
      <td>n-butanoic acid</td>
      <td>— 6.36</td>
      <td>0.62</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>53.9</td>
      <td>0.21</td>
      <td>0.79</td>
      <td>— 1.92</td>
      <td>— 0.96</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>NaN</td>
      <td>phenol</td>
      <td>— 5.64</td>
      <td>0.89</td>
      <td>0.52</td>
      <td>0.30</td>
      <td>‘53.9</td>
      <td>0.81</td>
      <td>1.46</td>
      <td>— 0.70</td>
      <td>—0.82</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>NaN</td>
      <td>toluene</td>
      <td>— 3.56</td>
      <td>0.52</td>
      <td>0.00</td>
      <td>0.14</td>
      <td>60.0</td>
      <td>0.60</td>
      <td>2.70</td>
      <td>2.89</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>NaN</td>
      <td>styrene</td>
      <td>— 3.75</td>
      <td>0.65</td>
      <td>0.00</td>
      <td>0.16</td>
      <td>60.2</td>
      <td>0.85</td>
      <td>2.95</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>NaN</td>
      <td>n-pentanol</td>
      <td>— 5.78</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>62.6</td>
      <td>0.22</td>
      <td>1.40</td>
      <td>— 0.39</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>NaN</td>
      <td>benzyl-OH</td>
      <td>— 5.78</td>
      <td>0.87</td>
      <td>0.33</td>
      <td>0.56</td>
      <td>64.0</td>
      <td>0.80</td>
      <td>1.10</td>
      <td>— 0.62</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>NaN</td>
      <td>n-pentanoic acid</td>
      <td>—6.01</td>
      <td>0.60</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>64.1</td>
      <td>0.21</td>
      <td>1.33</td>
      <td>—1.31</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>NaN</td>
      <td>2-chlorophenol</td>
      <td>— 5.04</td>
      <td>0.88</td>
      <td>0.32</td>
      <td>0.31</td>
      <td>66.0</td>
      <td>0.85</td>
      <td>2.15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>NaN</td>
      <td>4-chlorophenol</td>
      <td>— 5.00</td>
      <td>1.08</td>
      <td>0.67</td>
      <td>0.20</td>
      <td>66.0</td>
      <td>0.92</td>
      <td>2.39</td>
      <td>—1.31</td>
      <td>—0.12</td>
    </tr>
    <tr>
      <th>20</th>
      <td>20</td>
      <td>NaN</td>
      <td>m-cresol</td>
      <td>— 5.38</td>
      <td>0.88</td>
      <td>0.57</td>
      <td>0.34</td>
      <td>67.6</td>
      <td>0.82</td>
      <td>1.96</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>NaN</td>
      <td>o-cresol</td>
      <td>~— 5,36</td>
      <td>0.86</td>
      <td>0.52</td>
      <td>0.30</td>
      <td>67.6</td>
      <td>0.84</td>
      <td>1.95</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>22</td>
      <td>NaN</td>
      <td>p-cresol</td>
      <td>— 5.29</td>
      <td>0.87</td>
      <td>0.57</td>
      <td>0.31</td>
      <td>67.6</td>
      <td>0.82</td>
      <td>1.96</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>NaN</td>
      <td>4-bromophenol</td>
      <td>— 5.00</td>
      <td>1.17</td>
      <td>0.67</td>
      <td>0.20</td>
      <td>70.0</td>
      <td>1.08</td>
      <td>2.59</td>
      <td>—0.11</td>
      <td>—0.20</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>NaN</td>
      <td>4-nitrophenol</td>
      <td>—5.81</td>
      <td>1.72</td>
      <td>0.82</td>
      <td>0.26</td>
      <td>71.0</td>
      <td>1.07</td>
      <td>1.96</td>
      <td>—2.0</td>
      <td>—2.15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>NaN</td>
      <td>3-nitrophenol</td>
      <td>—5.81</td>
      <td>1.57</td>
      <td>0.79</td>
      <td>0.23</td>
      <td>71.0</td>
      <td>1.05</td>
      <td>2.00</td>
      <td>—1.4</td>
      <td>— 1.23</td>
    </tr>
    <tr>
      <th>26</th>
      <td>26</td>
      <td>NaN</td>
      <td>2-nitrophenol</td>
      <td>— 4,56</td>
      <td>1.05</td>
      <td>0.05</td>
      <td>0.37</td>
      <td>71.0</td>
      <td>1.02</td>
      <td>1.80</td>
      <td>—1.4</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>NaN</td>
      <td>ethylbenzene</td>
      <td>— 3.48</td>
      <td>0.51</td>
      <td>0.00</td>
      <td>0.15</td>
      <td>72.3</td>
      <td>0.60</td>
      <td>3.15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>28</td>
      <td>NaN</td>
      <td>n-hexanol</td>
      <td>—5.45</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>72.9</td>
      <td>0.21</td>
      <td>2.03</td>
      <td>0.11</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>29</th>
      <td>29</td>
      <td>NaN</td>
      <td>n-hexanoic acid</td>
      <td>—5.44</td>
      <td>0.60</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>74.3</td>
      <td>0.17</td>
      <td>1.89</td>
      <td>— 0.85</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>NaN</td>
      <td>B-naphthol</td>
      <td>—5.11</td>
      <td>1.08</td>
      <td>0.61</td>
      <td>0.40</td>
      <td>79.5</td>
      <td>1.52</td>
      <td>2.84</td>
      <td>1.77</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>31</th>
      <td>31</td>
      <td>NaN</td>
      <td>n-heptanol</td>
      <td>— 5.05</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>83.1</td>
      <td>0.21</td>
      <td>2.49</td>
      <td>0.77</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>32</th>
      <td>32</td>
      <td>NaN</td>
      <td>n-heptanoic acid</td>
      <td>— 5.28</td>
      <td>0.60</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>84.6</td>
      <td>0.15</td>
      <td>2.33</td>
      <td>— 0.29</td>
      <td>1.16</td>
    </tr>
    <tr>
      <th>33</th>
      <td>33</td>
      <td>NaN</td>
      <td>n-octanol</td>
      <td>— 4.84</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>93.3</td>
      <td>0.20</td>
      <td>3.15</td>
      <td>1.62</td>
      <td>1.65</td>
    </tr>
    <tr>
      <th>34</th>
      <td>34</td>
      <td>NaN</td>
      <td>n-octanoic acid</td>
      <td>—5.21</td>
      <td>0.60</td>
      <td>0.60</td>
      <td>0.45</td>
      <td>94.8</td>
      <td>0.15</td>
      <td>2.83</td>
      <td>0.41</td>
      <td>1.95</td>
    </tr>
    <tr>
      <th>35</th>
      <td>35</td>
      <td>NaN</td>
      <td>n-nonanol</td>
      <td>—4.77</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>104</td>
      <td>0.19</td>
      <td>3.68</td>
      <td>1.97</td>
      <td>2.28</td>
    </tr>
    <tr>
      <th>36</th>
      <td>36</td>
      <td>NaN</td>
      <td>n-decanol</td>
      <td>— 4.66</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>114</td>
      <td>0.19</td>
      <td>4,24</td>
      <td>2.56</td>
      <td>2.91</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The output above looks like something to keep, so we will add <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to overwrite the original dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 12 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   Unnamed: 0    37 non-null     int64  
 1   Unnamed: 0.1  1 non-null      object 
 2   Compound      37 non-null     object 
 3   log P         37 non-null     object 
 4   II            37 non-null     float64
 5   Hy            37 non-null     float64
 6   H,            37 non-null     float64
 7   MV            37 non-null     object 
 8   R,            37 non-null     float64
 9   log Kou       37 non-null     object 
 10  log Kyex      31 non-null     object 
 11  log Kpep      25 non-null     object 
dtypes: float64(4), int64(1), object(7)
memory usage: 3.6+ KB
</pre></div>
</div>
</div>
</div>
<p>We can drop the final two columns using the <code class="docutils literal notranslate"><span class="pre">drop</span></code> function. You can use this when you have specific rows or columns you would like to discard. Again, we use <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> to drop columns, then we pass the column name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Unnamed: 0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="changing-column-names">
<h2>Changing column names<a class="headerlink" href="#changing-column-names" title="Permalink to this headline">¶</a></h2>
<p>Our column names are still incorrect. You will likely want to change them to make the table more legible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 10 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Compound  37 non-null     object 
 1   log P     37 non-null     object 
 2   II        37 non-null     float64
 3   Hy        37 non-null     float64
 4   H,        37 non-null     float64
 5   MV        37 non-null     object 
 6   R,        37 non-null     float64
 7   log Kou   37 non-null     object 
 8   log Kyex  31 non-null     object 
 9   log Kpep  25 non-null     object 
dtypes: float64(4), object(6)
memory usage: 3.0+ KB
</pre></div>
</div>
</div>
</div>
<p>We might now want to clean up the column names and make sure they are descriptive. You can see the column names using <code class="docutils literal notranslate"><span class="pre">table1.columns</span></code>. You can either rename the columns by setting <code class="docutils literal notranslate"><span class="pre">table1.columns</span></code> to a list of the appropriate length, or you can use <code class="docutils literal notranslate"><span class="pre">table1.rename</span></code>. In the <code class="docutils literal notranslate"><span class="pre">.rename</span></code> method, you put the argument <code class="docutils literal notranslate"><span class="pre">columns</span></code> and set it equal to a dictionary (curly brackets) where you use the syntax</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;current_column_name&quot;</span><span class="p">:</span> <span class="s2">&quot;new_column_name&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Compound&#39;, &#39;log P&#39;, &#39;II&#39;, &#39;Hy&#39;, &#39;H,&#39;, &#39;MV&#39;, &#39;R,&#39;, &#39;log Kou&#39;,
       &#39;log Kyex&#39;, &#39;log Kpep&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;II&quot;</span><span class="p">:</span> <span class="s2">&quot;pi&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="s2">&quot;Hd&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;H,&quot;</span><span class="p">:</span> <span class="s2">&quot;Ha&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;R,&quot;</span><span class="p">:</span> <span class="s2">&quot;R_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;log Kou&quot;</span><span class="p">:</span> <span class="s2">&quot;log K_oct&quot;</span><span class="p">,</span>
    <span class="s2">&quot;log Kyex&quot;</span><span class="p">:</span> <span class="s2">&quot;log K_hex&quot;</span><span class="p">,</span>
    <span class="s2">&quot;log Kpep&quot;</span><span class="p">:</span> <span class="s2">&quot;log K_hep&quot;</span>
                      
                      <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compound</th>
      <th>log P</th>
      <th>pi</th>
      <th>Hd</th>
      <th>Ha</th>
      <th>MV</th>
      <th>R_2</th>
      <th>log K_oct</th>
      <th>log K_hex</th>
      <th>log K_hep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>water</td>
      <td>— 6.85</td>
      <td>0.45</td>
      <td>0.82</td>
      <td>0.35</td>
      <td>10.6</td>
      <td>0.00</td>
      <td>— 1.38</td>
      <td>— 4,38</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>methanol</td>
      <td>— 6.68</td>
      <td>0.44</td>
      <td>0.43</td>
      <td>0.47</td>
      <td>21.7</td>
      <td>0.28</td>
      <td>—0.73</td>
      <td>— 2.42</td>
      <td>— 2.80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>methanoic acid</td>
      <td>— 7.08</td>
      <td>0.60</td>
      <td>0.75</td>
      <td>0.38</td>
      <td>22.3</td>
      <td>0.30</td>
      <td>—0.54</td>
      <td>— 3.93</td>
      <td>— 3.63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ethanol</td>
      <td>— 6.66</td>
      <td>0.42</td>
      <td>0.37</td>
      <td>0.48</td>
      <td>31.9</td>
      <td>0.25</td>
      <td>—0.32</td>
      <td>—2.24</td>
      <td>—2.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ethanoic acid</td>
      <td>—7.01</td>
      <td>0.65</td>
      <td>0.61</td>
      <td>0.45</td>
      <td>33.4</td>
      <td>0.27</td>
      <td>—0.31</td>
      <td>— 3.28</td>
      <td>—2.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="fixing-data-types">
<h2>Fixing Data Types<a class="headerlink" href="#fixing-data-types" title="Permalink to this headline">¶</a></h2>
<p>When examining <code class="docutils literal notranslate"><span class="pre">.info</span></code> , you’ll notice that a lot of our columns which should be numbers are still ‘objects’ or strings. We would like <code class="docutils literal notranslate"><span class="pre">log</span> <span class="pre">P</span></code>, for example to be numeric. Typically if a column appears that it should be numeric, but pandas does not automatically cast it as such, it is because there are some non-numeric characters in the column which pandas could not decide what to do with. We will need to examine these, decide what to do with them, then cast the column as numeric.</p>
<p>There are a few ways to do this, but we’ll use the pandas function <code class="docutils literal notranslate"><span class="pre">to_numeric</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Compound   37 non-null     object 
 1   log P      37 non-null     object 
 2   pi         37 non-null     float64
 3   Hd         37 non-null     float64
 4   Ha         37 non-null     float64
 5   MV         37 non-null     object 
 6   R_2        37 non-null     float64
 7   log K_oct  37 non-null     object 
 8   log K_hex  31 non-null     object 
 9   log K_hep  25 non-null     object 
dtypes: float64(4), object(6)
memory usage: 3.0+ KB
</pre></div>
</div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">to_numeric</span></code> function without any additional inputs will fail on this data set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;— 6.85&quot;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="n">b00e34002272</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">])</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/tools/numeric.py</span> in <span class="ni">to_numeric</span><span class="nt">(arg, errors, downcast)</span>
<span class="nn">    152         coerce_numeric = errors not</span> in <span class="nt">(&quot;ignore&quot;, &quot;raise&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">154</span>             <span class="n">values</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">maybe_convert_numeric</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>                 <span class="n">values</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="n">coerce_numeric</span><span class="o">=</span><span class="n">coerce_numeric</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>             <span class="p">)</span>

<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;— 6.85&quot; at position 0
</pre></div>
</div>
</div>
</div>
<p>Scrolling to the bottom of this message and reading the error, you will see it is having a problem reading the value <code class="docutils literal notranslate"><span class="pre">&quot;—</span> <span class="pre">6.85&quot;</span></code>. It may not seem obvious what this problem is at first.</p>
<p>When we run into a problem like this we have a few options. You could choose to handle the errors differently. Pandas will let you set what you would like for it to do when it is unable to cast a value. By default, it will fail (which is what se wee above). For example, you could also set errors to be ignored (which would result in the column being unchanged, there would just be no error raised) or to “coerce” the values. Choosing “coerce” means that anything that can’t be cast as numeric will be put as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>Let’s see what happens when we set errors to coerce.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    NaN
1    NaN
2    NaN
3    NaN
4    NaN
5    NaN
6    NaN
7    NaN
8    NaN
9    NaN
10   NaN
11   NaN
12   NaN
13   NaN
14   NaN
15   NaN
16   NaN
17   NaN
18   NaN
19   NaN
20   NaN
21   NaN
22   NaN
23   NaN
24   NaN
25   NaN
26   NaN
27   NaN
28   NaN
29   NaN
30   NaN
31   NaN
32   NaN
33   NaN
34   NaN
35   NaN
36   NaN
Name: log P, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This unfortunately results in no numeric characters being recognized.</p>
<p>We have to do a little bit more processing to the values for this to work. If you examine the columns, you may notice that the negative sign is a little off. It is <code class="docutils literal notranslate"><span class="pre">—</span></code> when it should be <code class="docutils literal notranslate"><span class="pre">-</span></code>. This is very slight, and might be hard to see, but it is important to change for this data set.</p>
<p>We will want to replace all <code class="docutils literal notranslate"><span class="pre">—</span></code> with <code class="docutils literal notranslate"><span class="pre">-</span></code>. We could accomplish this using the string method <code class="docutils literal notranslate"><span class="pre">replace</span></code>. Strings in Python have a number of methods. The <code class="docutils literal notranslate"><span class="pre">replace</span></code> method allows us to replace a substring within a string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_string</span> <span class="o">=</span> <span class="s2">&quot;Hello world.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Hello world!&#39;
</pre></div>
</div>
</div>
</div>
<p>The split command is another string method you are probably familiar with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Hello&#39;, &#39;world.&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pandas-string-methods">
<h2>Pandas string methods<a class="headerlink" href="#pandas-string-methods" title="Permalink to this headline">¶</a></h2>
<p>If we want to use these on a column in a pandas dataframe, you might think to use <code class="docutils literal notranslate"><span class="pre">apply</span></code>, which we learned about in the last session. However, you will notice that the <code class="docutils literal notranslate"><span class="pre">replace</span></code> method acts on a the string and doesn’t fit into <code class="docutils literal notranslate"><span class="pre">apply</span></code>.</p>
<p>Luckily, when pandas columns are strings, we can use string methods on the whole column by adding <code class="docutils literal notranslate"><span class="pre">.str.function</span></code>. For example, to replace the minus signs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;—&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      - 6.85
1      - 6.68
2      - 7.08
3      - 6.66
4       -7.01
5      - 6.41
6       -7.01
7      - 5.90
8     -4,.5]1
9      - 5.35
10     - 6.16
11     - 6.36
12     - 5.64
13     - 3.56
14     - 3.75
15     - 5.78
16     - 5.78
17      -6.01
18     - 5.04
19     - 5.00
20     - 5.38
21    ~- 5,36
22     - 5.29
23     - 5.00
24      -5.81
25      -5.81
26     - 4,56
27     - 3.48
28      -5.45
29      -5.44
30      -5.11
31     - 5.05
32     - 5.28
33     - 4.84
34      -5.21
35      -4.77
36     - 4.66
Name: log P, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;—&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="c1"># We still need to get rid of spaces</span>
<span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">table1</span><span class="p">[</span><span class="s2">&quot;log P&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Compound   37 non-null     object 
 1   log P      34 non-null     float64
 2   pi         37 non-null     float64
 3   Hd         37 non-null     float64
 4   Ha         37 non-null     float64
 5   MV         37 non-null     object 
 6   R_2        37 non-null     float64
 7   log K_oct  37 non-null     object 
 8   log K_hex  31 non-null     object 
 9   log K_hep  25 non-null     object 
dtypes: float64(5), object(5)
memory usage: 3.0+ KB
</pre></div>
</div>
</div>
</div>
<p>We actually need to change this character on all of our columns. However <code class="docutils literal notranslate"><span class="pre">str</span></code> methods only work on pandas series. If we want to replace a string across all of our DataFrame, we will use the <code class="docutils literal notranslate"><span class="pre">.replace</span></code> method. In order for it to recognize substrings, set the option <code class="docutils literal notranslate"><span class="pre">regex=True</span></code>. We will discuss <code class="docutils literal notranslate"><span class="pre">regex</span></code> more in the next session, but this is all you need to know about regex for the moment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;—&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">table1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="changing-the-data-type-of-multiple-columns">
<h2>Changing the data type of multiple columns<a class="headerlink" href="#changing-the-data-type-of-multiple-columns" title="Permalink to this headline">¶</a></h2>
<p>To change the data type of multiple columns, we will want to use the <code class="docutils literal notranslate"><span class="pre">pd.to_numeric</span></code> function on all of those columns. There are several ways you might choose to do this. For example, you might just choose to call the function for each column.</p>
<p>We can also accomplish this by using the <code class="docutils literal notranslate"><span class="pre">apply</span></code> operator which we learned about in the last session. The <code class="docutils literal notranslate"><span class="pre">apply</span></code> operator should be used whenever you want to apply a function to a row or column. In this case, we want to apply the <code class="docutils literal notranslate"><span class="pre">pd.to_numeric</span></code> function to each column.</p>
<p>Because we want to apply to the columns, we add the argument <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;water&quot;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">28</span><span class="o">-</span><span class="mi">19256207</span><span class="n">bc24</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">table1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/frame.py</span> in <span class="ni">apply</span><span class="nt">(self, func, axis, raw, result_type, args, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">7766</span>             <span class="n">kwds</span><span class="o">=</span><span class="n">kwds</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7767</span>         <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7768</span>         <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">7769</span> 
<span class="g g-Whitespace">   </span><span class="mi">7770</span>     <span class="k">def</span> <span class="nf">applymap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">na_action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">get_result</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_raw</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span> 
<span class="ne">--&gt; </span><span class="mi">185</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_standard</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span> 
<span class="g g-Whitespace">    </span><span class="mi">187</span>     <span class="k">def</span> <span class="nf">apply_empty_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">apply_standard</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span> 
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="k">def</span> <span class="nf">apply_standard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">276</span>         <span class="n">results</span><span class="p">,</span> <span class="n">res_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_series_generator</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> 
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="c1"># wrap results</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">apply_series_generator</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span>             <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series_gen</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>                 <span class="c1"># ignore SettingWithCopy here in case the user mutates</span>
<span class="ne">--&gt; </span><span class="mi">290</span>                 <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>                 <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ABCSeries</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span>                     <span class="c1"># If we have a view on v, we need to make a copy because</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/tools/numeric.py</span> in <span class="ni">to_numeric</span><span class="nt">(arg, errors, downcast)</span>
<span class="nn">    152         coerce_numeric = errors not</span> in <span class="nt">(&quot;ignore&quot;, &quot;raise&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">154</span>             <span class="n">values</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">maybe_convert_numeric</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>                 <span class="n">values</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="n">coerce_numeric</span><span class="o">=</span><span class="n">coerce_numeric</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>             <span class="p">)</span>

<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;water&quot; at position 0
</pre></div>
</div>
</div>
</div>
<p>When we try this code, we immediately see an error. We do not want to try to convert the first column to a number. We can use the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> function to exclude the first column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;-4,38&quot;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">29</span><span class="o">-</span><span class="mi">794</span><span class="n">ce36e093b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/frame.py</span> in <span class="ni">apply</span><span class="nt">(self, func, axis, raw, result_type, args, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">7766</span>             <span class="n">kwds</span><span class="o">=</span><span class="n">kwds</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7767</span>         <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7768</span>         <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">7769</span> 
<span class="g g-Whitespace">   </span><span class="mi">7770</span>     <span class="k">def</span> <span class="nf">applymap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">na_action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">get_result</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_raw</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span> 
<span class="ne">--&gt; </span><span class="mi">185</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_standard</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span> 
<span class="g g-Whitespace">    </span><span class="mi">187</span>     <span class="k">def</span> <span class="nf">apply_empty_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">apply_standard</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span> 
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="k">def</span> <span class="nf">apply_standard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">276</span>         <span class="n">results</span><span class="p">,</span> <span class="n">res_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_series_generator</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> 
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="c1"># wrap results</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/apply.py</span> in <span class="ni">apply_series_generator</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span>             <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series_gen</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>                 <span class="c1"># ignore SettingWithCopy here in case the user mutates</span>
<span class="ne">--&gt; </span><span class="mi">290</span>                 <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>                 <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ABCSeries</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span>                     <span class="c1"># If we have a view on v, we need to make a copy because</span>

<span class="nn">~/miniconda3/envs/python-scripting-2/lib/python3.9/site-packages/pandas/core/tools/numeric.py</span> in <span class="ni">to_numeric</span><span class="nt">(arg, errors, downcast)</span>
<span class="nn">    152         coerce_numeric = errors not</span> in <span class="nt">(&quot;ignore&quot;, &quot;raise&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">154</span>             <span class="n">values</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">maybe_convert_numeric</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>                 <span class="n">values</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="n">coerce_numeric</span><span class="o">=</span><span class="n">coerce_numeric</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>             <span class="p">)</span>

<span class="nn">pandas/_libs/lib.pyx</span> in <span class="ni">pandas._libs.lib.maybe_convert_numeric</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Unable to parse string &quot;-4,38&quot; at position 7
</pre></div>
</div>
</div>
</div>
<p>An error again! This time, we see failure because a string was incorrectly read from the pdf and could not be converted to a number. You could choose to handle this differently, but for this workshop we are just going to discard values like these.</p>
<p>If we were using <code class="docutils literal notranslate"><span class="pre">to_numeric</span></code> on a pandas series, we would use the option <code class="docutils literal notranslate"><span class="pre">errors=&quot;coerce&quot;</span></code>. You may not see immediately how to use this with the <code class="docutils literal notranslate"><span class="pre">apply</span></code> function, but fortunately, pandas allows us to pass additional arguments with <code class="docutils literal notranslate"><span class="pre">apply</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 37 entries, 0 to 36
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Compound   37 non-null     object 
 1   log P      34 non-null     float64
 2   pi         37 non-null     float64
 3   Hd         37 non-null     float64
 4   Ha         37 non-null     float64
 5   MV         36 non-null     float64
 6   R_2        37 non-null     float64
 7   log K_oct  36 non-null     float64
 8   log K_hex  30 non-null     float64
 9   log K_hep  24 non-null     float64
dtypes: float64(9), object(1)
memory usage: 3.0+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/potts_table1_clean.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="2-ocr-tabula.html" title="previous page">Reading data from PDFs</a>
    <a class='right-next' id="next-link" href="2-seaborn.html" title="next page">Plotting with seaborn</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jessica A. Nash<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-169902961-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>